---
import ThemeToggle from "./ThemeToggle.astro";

const { currentPath = "/" } = Astro.props;
const base = import.meta.env.BASE_URL;

const normalizePath = (p) => {
  const withBase = p.startsWith(base) ? p : `${base}${p.replace(/^\//, "")}`;
  return withBase.endsWith("/") ? withBase : `${withBase}/`;
};

const path = normalizePath(currentPath);

const isActive = (href) => {
  const full = normalizePath(href);
  if (full === `${base}blog/`) return path.startsWith(`${base}blog/`);
  return path === full;
};
---

<header class="site-header">
  <div class="site-header-inner">
    <a class="site-brand" href={base} aria-label="ホームに戻る">愛と幽相</a>

    <nav class="site-nav" aria-label="サイト内ナビゲーション">
      <a class={isActive(base) ? "is-active" : ""} href={base}>Home</a>
      <a class={isActive(`${base}blog/`) ? "is-active" : ""} href={`${base}blog/`}>Blog</a>
      <a href="https://github.com/itashin1201" target="_blank" rel="noopener noreferrer">GitHub</a>
    </nav>

    <ThemeToggle />
  </div>
</header>
